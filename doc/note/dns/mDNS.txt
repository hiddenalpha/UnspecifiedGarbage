

# Example: AACEAAAAAAcAAAAAGlN5c3RlbURvY3VtZW50YXRpb25TZXJ2aWNlDF9pYmlzaXBfaHR0cARfdGNwBWxvY2FsAAAhgAEAAA4QABIAAAAAH5AJYzItaHctbmF2wDnADAAQgAEAAA4QABAPcGF0aD0vaGVpbWRhbGwvF1RpY2tldFZhbGlkYXRpb25TZXJ2aWNlwCcAEIABAAAOEAAQD3BhdGg9L2hlaW1kYWxsL8B4ACGAAQAADhAACAAAAAAfkMBQF1N5c3RlbU1hbmFnZW1lbnRTZXJ2aWNlwCcAIYABAAAOEAAIAAAAAB+QwFDAwAAQgAEAAA4QABAPcGF0aD0vaGVpbWRhbGwvwFAAAYABAAAOEAAEwKgKAg==

00000000: 0000 8400 0000 0007 0000 0000 1a53 7973  .............Sys
00000010: 7465 6d44 6f63 756d 656e 7461 7469 6f6e  temDocumentation
00000020: 5365 7276 6963 650c 5f69 6269 7369 705f  Service._ibisip_
00000030: 6874 7470 045f 7463 7005 6c6f 6361 6c00  http._tcp.local.
00000040: 0021 8001 0000 0e10 0012 0000 0000 1f90  .!..............
00000050: 0963 322d 6877 2d6e 6176 c039 c00c 0010  .c2-hw-nav.9....
00000060: 8001 0000 0e10 0010 0f70 6174 683d 2f68  .........path=/h
00000070: 6569 6d64 616c 6c2f 1754 6963 6b65 7456  eimdall/.TicketV
00000080: 616c 6964 6174 696f 6e53 6572 7669 6365  alidationService
00000090: c027 0010 8001 0000 0e10 0010 0f70 6174  .'...........pat
000000a0: 683d 2f68 6569 6d64 616c 6c2f c078 0021  h=/heimdall/.x.!
000000b0: 8001 0000 0e10 0008 0000 0000 1f90 c050  ...............P
000000c0: 1753 7973 7465 6d4d 616e 6167 656d 656e  .SystemManagemen
000000d0: 7453 6572 7669 6365 c027 0021 8001 0000  tService.'.!....
000000e0: 0e10 0008 0000 0000 1f90 c050 c0c0 0010  ...........P....
000000f0: 8001 0000 0e10 0010 0f70 6174 683d 2f68  .........path=/h
00000100: 6569 6d64 616c 6c2f c050 0001 8001 0000  eimdall/.P......
00000110: 0e10 0004 c0a8 0a02                      ........

  && printf '\x00\x00\x84\x00\x00\x00\x00\x07\x00\x00\x00\x00\x1aSystemDocumentationService\x0c\x5f\x69\x62\x69\x73\x69\x70\x5f\x68\x74\x74\x70\x04\x5f\x74\x63\x70\x05\x6c\x6f\x63\x61\x6c\x00\x00\x21\x80\x01\x00\x00\x0e\x10\x00\x12\x00\x00\x00\x00\x1f\x90\x09\x63\x32\x2d\x68\x77\x2d\x6e\x61\x76\xc0\x39\xc0\x0c\x00\x10\x80\x01\x00\x00\x0e\x10\x00\x10\x0f\x70\x61\x74\x68\x3d\x2f\x68\x65\x69\x6d\x64\x61\x6c\x6c\x2f\x17\x54\x69\x63\x6b\x65\x74\x56\x61\x6c\x69\x64\x61\x74\x69\x6f\x6e\x53\x65\x72\x76\x69\x63\x65\xc0\x27\x00\x10\x80\x01\x00\x00\x0e\x10\x00\x10\x0f\x70\x61\x74\x68\x3d\x2f\x68\x65\x69\x6d\x64\x61\x6c\x6c\x2f\xc0\x78\x00\x21\x80\x01\x00\x00\x0e\x10\x00\x08\x00\x00\x00\x00\x1f\x90\xc0\x50\x17\x53\x79\x73\x74\x65\x6d\x4d\x61\x6e\x61\x67\x65\x6d\x65\x6e\x74\x53\x65\x72\x76\x69\x63\x65\xc0\x27\x00\x21\x80\x01\x00\x00\x0e\x10\x00\x08\x00\x00\x00\x00\x1f\x90\xc0\x50\xc0\xc0\x00\x10\x80\x01\x00\x00\x0e\x10\x00\x10\x0f\x70\x61\x74\x68\x3d\x2f\x68\x65\x69\x6d\x64\x61\x6c\x6c\x2f\xc0\x50\x00\x01\x80\x01\x00\x00\x0e\x10\x00\x04\xc0\xa8\x0a\x02' \
       | ncat --send-only -u "${DST_HOST?}" "5353"


  && ( `# Send an example mDNS discovery packet` \
    && printf '\x00\x00' `# Transaction ID` \
    && printf '\x84\x00' `# Flags` \
    && printf '\x00\x00' `# Questions` \
    && printf '\x00\x01' `# num Answer RRs` \
    && printf '\x00\x00' `# num Authority RRs` \
    && printf '\x00\x00' `# num Additional RRs` \
    && `# RR[0]` \
    && printf '\x0BGagaService' `# Instance` \
    && printf '\x05_http' `# Service` \
    && printf '\x04_tcp' `# Proto` \
    && printf '\x05local' `# Name` \
    && printf '\x00\x21' `# Type (TODO verify)` \
    && printf '\x80\x01' `# Class (very 1st bit means cache-flush=true)` \
    && printf '\x00\x00\x00\x05' `# TTL seconds` \
    && printf '\x00\x17' `# DataLen` \
    && printf '\x00\x00' `# Prio` \
    && printf '\x00\x00' `# Weight` \
    && printf '\x1F\x90' `# Port` \
    && printf '\x0BADevMachine.local' `# Target` \
    && `# RR[1]` \
  ) | ncat --send-only -u "${DST_HOST?}" "5353"



